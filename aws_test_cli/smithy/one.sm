$version "1.0"
namespace smithy.example

use aws.protocols#restJson1

///Broadcast messagess to all users
@restJson1
service Broadcast{
  version: "2021-09-01",
  resources: [Message]
}


resource Message{
  identifiers: {
    messageId: String
  },
  create: CreateMessage, 
  read: GetMessage,
  update: UpdateMessage,
  delete: DeleteMessage,
  list: ListMessages
}

@http(method:"POST", uri:"/messages")
operation CreateMessage{
  input: CreateMessageInput,
  output: CreateMessageOutput,
  errors: [ValidationmException]
}


structure CreateMessageInput{
  @required
  messageId: String,

  @idempotencyToken
  token: String
}

structure CreateMessageOutput{
  @required
  messageId: String
}

@readonly
@paginated(
  intpuToken: "nextToken",
  outputToken: "nextToken",
  items:"messages"
)
@http(method: "GET", uri:"messages")
operation ListMessages{
  input: ListMessagesInput, 
  output: ListMessagesOutput
}

struture ListMessagesInput{
  nextToken: String
}

structure ListMessagesOutput{
  nextToken: String, 
  messages: MessageList
}

